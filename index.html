<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login / Register | Employee Portal</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Poppins", sans-serif; }
    body { height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #667eea, #764ba2); }
    .container { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(15px); border-radius: 15px; box-shadow: 0 0 30px rgba(0, 0, 0, 0.2); width: 400px; padding: 30px; color: #fff;}
    h2 { text-align: center; margin-bottom: 20px; }
    input { width: 100%; padding: 12px; margin: 10px 0; border: none; border-radius: 8px; outline: none; background: rgba(255, 255, 255, 0.2); color: #fff; font-size: 15px;}
    input::placeholder { color: #ddd; }
    .btn { width: 100%; background: #6a11cb; color: white; padding: 12px; border: none; border-radius: 8px; cursor: pointer; transition: 0.3s; font-size: 16px;}
    .btn:hover { background: #2575fc; }
    .toggle { text-align: center; margin-top: 15px; cursor: pointer; font-size: 14px; color: #ddd; }
    .google-btn { background: white; color: #444; font-weight: 600; border: none; margin-top: 10px; display: flex; justify-content: center; align-items: center; gap: 8px; padding: 10px; border-radius: 6px; cursor: pointer; }
    .google-btn img { width: 20px; height: 20px; }
    .password-box { position: relative; }
    #togglePassword { position:absolute; right:15px; top:50%; transform:translateY(-50%); cursor:pointer; font-size:18px; }
    #rules { display:none; }
    #rules p { font-size: 12px; margin: 2px 0; }
    p#message { text-align: center; color: #f0f0f0; font-size: 14px; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h2 id="formTitle">Login</h2>

    <input type="text" id="name" placeholder="Full Name (Only for Register)" style="display:none;" />
    <input type="text" id="phone" placeholder="Phone Number (Only for Register)" style="display:none;" />
    <input type="email" id="email" placeholder="Email" />

    <div class="password-box">
      <input type="password" id="password" placeholder="Password" />
      <span id="togglePassword">üëÅÔ∏è</span>
    </div>

    <div id="rules">
      <p id="lower">‚ùå at least 1 lowercase letter</p>
      <p id="upper">‚ùå at least 1 uppercase letter</p>
      <p id="number">‚ùå at least 1 number</p>
      <p id="special">‚ùå at least 1 special character ($@#&!)</p>
      <p id="length">‚ùå minimum 8 characters</p>
    </div>

    <button class="btn" id="submitBtn">Login</button>
    <button class="google-btn" id="googleBtn">
      <img src="https://www.svgrepo.com/show/355037/google.svg" /> Sign in with Google
    </button>

    <p class="toggle" id="toggleForm">Don't have an account? Register</p>
    <p id="message"></p>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signInWithPopup, GoogleAuthProvider } 
      from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

    const firebaseConfig = {
  apiKey: "AIzaSyCr3Acxn1rtAEiH1-1VNDFkphmZbYil9SY",
  authDomain: "employeefire-4ee96.firebaseapp.com",
  databaseURL: "https://employeefire-4ee96-default-rtdb.firebaseio.com",
  projectId: "employeefire-4ee96",
  storageBucket: "employeefire-4ee96.firebasestorage.app",
  messagingSenderId: "853297636253",
  appId: "1:853297636253:web:6a28f90b9e6638f9dc0574"
};


    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    const nameField = document.getElementById("name");
    const phoneField = document.getElementById("phone");
    const email = document.getElementById("email");
    const password = document.getElementById("password");
    const toggleForm = document.getElementById("toggleForm");
    const submitBtn = document.getElementById("submitBtn");
    const formTitle = document.getElementById("formTitle");
    const message = document.getElementById("message");

    const lower = document.getElementById("lower");
    const upper = document.getElementById("upper");
    const number = document.getElementById("number");
    const special = document.getElementById("special");
    const lengthRule = document.getElementById("length");
    const rulesDiv = document.getElementById("rules");

    let isLogin = true;

    toggleForm.addEventListener("click", () => {
      isLogin = !isLogin;
      formTitle.textContent = isLogin ? "Login" : "Register";
      submitBtn.textContent = isLogin ? "Login" : "Register";
      toggleForm.textContent = isLogin ? "Don't have an account? Register" : "Already have an account? Login";
      nameField.style.display = isLogin ? "none" : "block";
      phoneField.style.display = isLogin ? "none" : "block";
      
      rulesDiv.style.display = "none"; // hide rules when switch
      password.value = "";
      message.textContent = "";
    });

    // eye icon toggle
    const togglePassword = document.getElementById("togglePassword");
    togglePassword.addEventListener("click", () => {
      if (password.type === "password") {
        password.type = "text";
        togglePassword.textContent = "üôà";
      } else {
        password.type = "password";
        togglePassword.textContent = "üëÅÔ∏è";
      }
    });

    function updateRule(element, valid) {
      element.textContent = (valid ? "‚úî " : "‚ùå ") + element.textContent.slice(2);
      element.style.color = valid ? "#0f0" : "#f00";
    }

    password.addEventListener("input", () => {
      const val = password.value;

      if (val.length === 0) rulesDiv.style.display = "none";
      else rulesDiv.style.display = "block";

      updateRule(lower, /[a-z]/.test(val));
      updateRule(upper, /[A-Z]/.test(val));
      updateRule(number, /[0-9]/.test(val));
      updateRule(special, /[$@#&!]/.test(val));
      updateRule(lengthRule, val.length >= 8);
    });

    async function attemptAuth() {
      const userEmail = email.value.trim();
      const userPass = password.value.trim();
      const userName = nameField.value.trim();
      const userPhone = phoneField.value.trim();
      message.textContent = "";

      if (!userEmail || !userPass || (!isLogin && (!userName || !userPhone))) {
        message.textContent = "Please fill all fields.";
        return;
      }

      const passOk =
        /[a-z]/.test(userPass) &&
        /[A-Z]/.test(userPass) &&
        /[0-9]/.test(userPass) &&
        /[$@#&!]/.test(userPass) &&
        userPass.length >= 8;

      if (!passOk) {
        message.textContent = "Complete all password rules first!";
        return;
      }

      try {
        if (isLogin) {
          await signInWithEmailAndPassword(auth, userEmail, userPass);
          window.location.href = "user-management.html";
        } else {
          await createUserWithEmailAndPassword(auth, userEmail, userPass);
          message.textContent = "‚úÖ Registered Successfully!";
        }
      } catch (error) { message.textContent = "‚ùå " + error.message; }
    }

    submitBtn.addEventListener("click", attemptAuth);

    googleBtn.addEventListener("click", async () => {
      try {
        await signInWithPopup(auth, provider);
        window.location.href = "user-management.html";
      } catch (error) { message.textContent = "‚ùå " + error.message; }
    });
  </script>
</body>
</html>
